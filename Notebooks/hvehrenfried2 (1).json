{"paragraphs":[{"text":"%spark.pyspark\n\n\neventos = spark.read.format(\"com.databricks.spark.csv\")\\\n    .option('delimiter', ';')\\\n    .option('charset', 'iso-8859-1')\\\n    .option('header', \"true\")\\\n    .load(\"data/eventos.csv\")\n    \n    \n\n","user":"anonymous","dateUpdated":"2017-03-23T14:23:13-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1490287623497_1712133664","id":"20170323-134703_1862994499","dateCreated":"2017-03-23T13:47:03-0300","dateStarted":"2017-03-23T13:51:55-0300","dateFinished":"2017-03-23T13:51:55-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11073"},{"text":"%spark.pyspark\n\neventos.printSchema()","user":"anonymous","dateUpdated":"2017-03-23T13:52:22-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- EVE_IDF: string (nullable = true)\n |-- EVE_TITULO: string (nullable = true)\n |-- EVE_DESCRICAO: string (nullable = true)\n |-- EVE_PUBLICADO: string (nullable = true)\n |-- EVE_DATA_INICIO: string (nullable = true)\n |-- EVE_DATA_TERMINO: string (nullable = true)\n |-- SEE_STR_NOME: string (nullable = true)\n |-- EVE_DATA_CADASTRO: string (nullable = true)\n |-- EVE_LOCAL: string (nullable = true)\n |-- EVE_ENDERECO: string (nullable = true)\n |-- EVE_HORARIO: string (nullable = true)\n |-- EVE_REPETIR: string (nullable = true)\n |-- EVE_DIA: string (nullable = true)\n |-- BAI_DESCRICAO: string (nullable = true)\n |-- ETE_DESCRICAO: string (nullable = true)\n |-- ETI_DESCRICAO: string (nullable = true)\n |-- REG_DESCRICAO: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1490287827050_1474867830","id":"20170323-135027_51800123","dateCreated":"2017-03-23T13:50:27-0300","dateStarted":"2017-03-23T13:52:22-0300","dateFinished":"2017-03-23T13:52:22-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11074"},{"text":"%spark.pyspark\n\nrdd = eventos.filter(year('eve_data_inicio') > '2016').select('eve_titulo', 'eve_endereco').rdd","user":"anonymous","dateUpdated":"2017-03-23T13:59:12-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1490287842394_-1697371527","id":"20170323-135042_456966884","dateCreated":"2017-03-23T13:50:42-0300","dateStarted":"2017-03-23T13:59:12-0300","dateFinished":"2017-03-23T13:59:12-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11075"},{"text":"%spark.pyspark\n\nfor r in rdd.collect():\n    print r","user":"anonymous","dateUpdated":"2017-03-23T13:59:14-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Row(eve_titulo=u'FESTIVAL DE F\\xc9RIAS DE VER\\xc3O 2017', eve_endereco=u'Rua Francisco Claudino Ferreira, s/n\\xba')\nRow(eve_titulo=u'FESTIVAL DE F\\xc9RIAS DE VER\\xc3O 2017', eve_endereco=u'Rua Ourizona, 1681')\nRow(eve_titulo=u'FESTIVAL DE F\\xc9RIAS DE VER\\xc3O 2017', eve_endereco=u'Rua das Tecnologias - s/n\\xba - Vila Tecnol\\xf3gica')\nRow(eve_titulo=u'REUNI\\xc3O DA COMISS\\xc3O DE SA\\xdaDE DA UPA SITIO CERCADO', eve_endereco=u'Rua Dr Levy Buquera, 158')\nRow(eve_titulo=u'REUNI\\xc3O DO CONSELHO LOCAL DE SAUDE DO S\\xc3O JO\\xc3O DEL REY', eve_endereco=u'Rua Realeza, 259')\nRow(eve_titulo=u'REUNI\\xc3O DO CONSELHO LOCAL DE SAUDE DO SAMBAQUI', eve_endereco=u'Rua Roberto Dala Barba, 44')\nRow(eve_titulo=u'REUNI\\xc3O DO CONSELHO LOCAL DE SAUDE DO COQUEIROS', eve_endereco=u'Rua Coronel Victor Agner Kendrick, 80')\nRow(eve_titulo=u'REUNI\\xc3O DO CONSELHO LOCAL DE SAUDE DO SALVADOR ALLENDE', eve_endereco=u'Rua Celeste Tortato Gabardo, S/N.\\xba')\nRow(eve_titulo=u'REUNI\\xc3O DO CONSELHO LOCAL DE SAUDE DO OSTERNACK', eve_endereco=u'Rua Miguel Rossetim, 100')\nRow(eve_titulo=u'REUNI\\xc3O DO CONSELHO DISTRITAL DE SAUDE', eve_endereco=u'Rua Ant\\xf4nio Schwartz, 35')\nRow(eve_titulo=u'REUNI\\xc3O DO CONSELHO LOCAL DE SAUDE DA UMS BAIRRO NOVO', eve_endereco=u'Rua Paulo Rio Branco De Macedo, 791')\nRow(eve_titulo=u'REUNI\\xc3O DO CONSELHO LOCAL DE SA\\xdaDE DO JO\\xc3O C\\xc2NDIDO', eve_endereco=u'Rua Ourizona, 2525')\nRow(eve_titulo=u'REUNI\\xc3O DA COMISS\\xc3O DA MATERNIDADE DO BAIRRO NOVO', eve_endereco=u'Rua Jussara, 2234')\nRow(eve_titulo=u'REUNI\\xc3O DO CONSELHO LOCAL DE SAUDE DO PARIGOT DE SOUZA', eve_endereco=u'Rua Jo\\xe3o Eloy de Souza, 111')\nRow(eve_titulo=u'REUNI\\xc3O DO CONSELHO LOCAL DE SAUDE DA UMS NOSSA SENHORA APARECIDA', eve_endereco=u'Rua Ant\\xf4nio Schwartz, 35')\nRow(eve_titulo=u'REUNI\\xc3O DO CONSELHO LOCAL DE SA\\xdaDE DA UMS UMBAR\\xc1 I', eve_endereco=u'Rua Dep. Pinheiro J\\xfanior, 915')\nRow(eve_titulo=u'REUNI\\xc3O DO CONSELHO LOCAL DE SAUDE DO XAPINHAL', eve_endereco=u'Rua Elbe de Macedo, S/N.\\xba')\nRow(eve_titulo=u'REUNI\\xc3O DO CONSELHO LOCAL DE SAUDE DA UMS UMBAR\\xc1 II', eve_endereco=u'Rua Nicola Pellanda, 4800')\nRow(eve_titulo=u'BAILE DE CARNAVAL DA MELHOR IDADE', eve_endereco=u'Rua Arapongas, 1399')\nRow(eve_titulo=u'BAILE DE CARNAVAL - INFANTIL', eve_endereco=u'Rua Ourizona, 1681')\nRow(eve_titulo=u'BAILE DE CARNAVAL - ADULTO', eve_endereco=u'Rua Ourizona, 1681')\nRow(eve_titulo=u'BAILE DE CARNAVAL DA MELHOR IDADE', eve_endereco=u'Avenida Presidente Kennedy')\nRow(eve_titulo=u'BAILE DE CARNAVAL DA MELHOR IDADE BAIRRO NOVO - FAS e SMELJ', eve_endereco=None)\nRow(eve_titulo=u'DESFILE DO RANCHO DAS FLORES', eve_endereco=None)\nRow(eve_titulo=u'Agita Boa Vista', eve_endereco=u'Rua Guilherme Ihlenfeldt, 245')\nRow(eve_titulo=u'Palestras em Comemora\\xe7\\xe3o ao Dia Internacional da Mulher', eve_endereco=u'Avenida Paran\\xe1, 3600 \\x96 Boa Vista')\nRow(eve_titulo=u'Pedala Boa Vista', eve_endereco=u'Eduardo Geronasso, 1600 - Bacacheri')\nRow(eve_titulo=u'Palestra Dia Internacional da Mulher e Gin\\xe1stica Laboral', eve_endereco=u'Pra\\xe7a Rui Barbosa')\nRow(eve_titulo=u'Caminhada Dia Internacional da Mulher \\x96 Visita ao Est\\xe1dio da Arena', eve_endereco=u'Rua 24 de Maio, s/n')\nRow(eve_titulo=u'Curso de Teclado', eve_endereco=u'Rua das Tecnologias, 31 - Vila Tecnol\\xf3gica')\nRow(eve_titulo=u'CURSO DE VIOLINO', eve_endereco=u'Rua das Tecnologias, 31 - Vila Tecnol\\xf3gica')\nRow(eve_titulo=u'PEDALA CURITIBA BAIRRO NOVO', eve_endereco=u'Rua Tijucas do Sul, 1700')\nRow(eve_titulo=u'Corrida das Cem Voltas', eve_endereco=u'Rua Lothario Mensser, 1210 \\x96 Jardim Bot\\xe2nico')\nRow(eve_titulo=u'Oficina de Skate - Viva Jovem', eve_endereco=u'Rua Loth\\xe1rio Boutin, 289')\nRow(eve_titulo=u'FESTA ANIVERS\\xc1RIO 324 ANOS DE CURITIBA & 25 ANOS DO BAIRRO NOVO', eve_endereco=u'Rua Nova Aurora x Nova Esperan\\xe7a - Vila Tecnol\\xf3gica')\nRow(eve_titulo=u'PEDALA CURITIBA BAIRRO NOVO', eve_endereco=u'Rua Tijucas do Sul, 1700')\nRow(eve_titulo=u'PEDALA CURITIBA BAIRRO NOVO', eve_endereco=u'Rua Tijucas do Sul, 1700')\nRow(eve_titulo=u'Passos na Hist\\xf3ria', eve_endereco=u'Av. Jaime Reis, 20')\nRow(eve_titulo=u'Jogos Escolares de Curitiba -  V\\xf4lei de Praia', eve_endereco=u'Av. Prefeito Loth\\xe1rio Meissner, s/n')\nRow(eve_titulo=u'Jogos Escolares de Curitiba -  V\\xf4lei de Praia', eve_endereco=u'Av. Prefeito Loth\\xe1rio Meissner, s/n')\nRow(eve_titulo=u'Copa Curitiba de Basquete em Cadeira de Rodas', eve_endereco=u'Rua Dom Jos\\xe9 Marello, 101')\nRow(eve_titulo=u'Festa Anivers\\xe1rio de Curitiba', eve_endereco=u'Avenida Candido Hartmann, s/n')\nRow(eve_titulo=u'Viva Jovem - Break Dance', eve_endereco=u'Rua Hilda Cadilhe de Oliveira, s/n')\nRow(eve_titulo=u'Viva Jovem \\x96 Oficina de Fotografia', eve_endereco=u'Avenida Winston Churchill, 2033')\nRow(eve_titulo=u'Aul\\xe3o de Gin\\xe1stica', eve_endereco=u'Rua Inocentte Rebelatto, s/n')\nRow(eve_titulo=u'Aul\\xe3o nas Academias ao Ar Livre', eve_endereco=u'Rua Paulo Set\\xfabal, s/n')\nRow(eve_titulo=u'Caminhada da Mulher', eve_endereco=u'Rua Pastor Ant\\xf4nio Polito, 2200')\n"}]},"apps":[],"jobName":"paragraph_1490288032497_957840285","id":"20170323-135352_1475479062","dateCreated":"2017-03-23T13:53:52-0300","dateStarted":"2017-03-23T13:59:15-0300","dateFinished":"2017-03-23T13:59:15-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11076"},{"text":"%spark.pyspark\n\n# rdd.map( lambda linha : linha ).collect()\nfrom geopy.geocoders import Nominatim\n\ngeolocator = Nominatim()\n\nlocation = geolocator.geocode(rdd.first()[1\n\n","user":"anonymous","dateUpdated":"2017-03-23T14:14:51-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1490288285293_792365965","id":"20170323-135805_485362343","dateCreated":"2017-03-23T13:58:05-0300","dateStarted":"2017-03-23T14:13:40-0300","dateFinished":"2017-03-23T14:13:41-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11077"},{"text":"%spark.pyspark\n\nlista = rdd.map( lambda linha : (linha[0], geolocator.geocode(linha[1]))).collect()","user":"anonymous","dateUpdated":"2017-03-23T14:18:59-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490288478874_-1027051931","id":"20170323-140118_1776028614","dateCreated":"2017-03-23T14:01:18-0300","dateStarted":"2017-03-23T14:20:15-0300","dateFinished":"2017-03-23T14:21:52-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11078","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark.pyspark\nimport folium\n\nlat = -25.45\nlgn = -49.22\n\nmymap = folium.Map(location=[lat,lng], zoom_start=12)\nmymap.save('hvehrenfried.html')\n# Para acessar: file:///home/soft/spark/zeppelin/hvehrenfried.html","user":"anonymous","dateUpdated":"2017-03-23T14:26:40-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490289277616_327770419","id":"20170323-141437_1751743313","dateCreated":"2017-03-23T14:14:37-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11079","dateFinished":"2017-03-23T14:26:27-0300","dateStarted":"2017-03-23T14:26:15-0300"},{"text":"%spark.pyspark\n\nfor item in lista:\n    if item[1]:\n        title = item[0]\n        lat = item[1][1][0]\n        lng = item[1][1][1]\n        folium.Marker([lat, lng], popup=title, icon = folium.Icon(color = 'green')).add_to(mymap)\nmymap.save('hvehrenfried.html')","user":"anonymous","dateUpdated":"2017-03-23T14:36:15-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490289783242_1390579341","id":"20170323-142303_1589911419","dateCreated":"2017-03-23T14:23:03-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11509","dateFinished":"2017-03-23T14:36:19-0300","dateStarted":"2017-03-23T14:36:15-0300","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark.pyspark\n\n\nguarda = open('data/guarda.csv')","user":"anonymous","dateUpdated":"2017-03-23T14:38:28-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490290169921_1999420667","id":"20170323-142929_1100128933","dateCreated":"2017-03-23T14:29:29-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11596","dateFinished":"2017-03-23T14:38:28-0300","dateStarted":"2017-03-23T14:38:28-0300","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark.pyspark\n","user":"anonymous","dateUpdated":"2017-03-23T14:38:28-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490290708484_-629602505","id":"20170323-143828_158984898","dateCreated":"2017-03-23T14:38:28-0300","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11778"}],"name":"hvehrenfried2","id":"2CERJTXUY","angularObjects":{"2C9BJDF71:shared_process":[],"2CA48URHJ:shared_process":[],"2C7WPSS7Z:shared_process":[],"2C6XSXTG6:shared_process":[],"2C9MUFN7T:shared_process":[],"2CA3NX254:shared_process":[],"2CAGDTKQW:shared_process":[],"2C8DAACDP:shared_process":[],"2C89WSY73:shared_process":[],"2C9AFPAG7:shared_process":[],"2C9C28FR6:shared_process":[],"2CA264QZ3:shared_process":[],"2C8K3X79M:shared_process":[],"2CAEVM34E:shared_process":[],"2C7SGT8S6:shared_process":[],"2C82EREVW:shared_process":[],"2C8UQZG7B:shared_process":[],"2C988KJAT:shared_process":[],"2C7E1FE49:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}