{"paragraphs":[{"text":"\n%spark.pyspark\n\ndf = spark.read.csv(\"data/wdbc.data\", inferSchema=True)\ndfBcw = spark.read.csv(\"data/breast-cancer-wisconsin.data\", inferSchema=True)\n# df.where(\"_c1 = 'B'\").show()\n# dfBcw.printSchema()\ndf.columns\n","user":"anonymous","dateUpdated":"2017-03-30T14:10:16-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":" interpreter not found"}]},"apps":[],"jobName":"paragraph_1490891849302_9937565","id":"20170330-133729_1542183422","dateCreated":"2017-03-30T13:37:29-0300","dateStarted":"2017-03-30T14:03:33-0300","dateFinished":"2017-03-30T14:03:33-0300","status":"ERROR","errorMessage":"org.apache.zeppelin.interpreter.InterpreterException: %spark.pyspar interpreter not found\n\tat org.apache.zeppelin.interpreter.InterpreterFactory.getInterpreter(InterpreterFactory.java:1350)\n\tat org.apache.zeppelin.notebook.Note.run(Note.java:567)\n\tat org.apache.zeppelin.socket.NotebookServer.persistAndExecuteSingleParagraph(NotebookServer.java:1626)\n\tat org.apache.zeppelin.socket.NotebookServer.runAllParagraphs(NotebookServer.java:1573)\n\tat org.apache.zeppelin.socket.NotebookServer.onMessage(NotebookServer.java:266)\n\tat org.apache.zeppelin.socket.NotebookSocket.onWebSocketText(NotebookSocket.java:59)\n\tat org.eclipse.jetty.websocket.common.events.JettyListenerEventDriver.onTextMessage(JettyListenerEventDriver.java:128)\n\tat org.eclipse.jetty.websocket.common.message.SimpleTextMessage.messageComplete(SimpleTextMessage.java:69)\n\tat org.eclipse.jetty.websocket.common.events.AbstractEventDriver.appendMessage(AbstractEventDriver.java:65)\n\tat org.eclipse.jetty.websocket.common.events.JettyListenerEventDriver.onTextFrame(JettyListenerEventDriver.java:122)\n\tat org.eclipse.jetty.websocket.common.events.AbstractEventDriver.incomingFrame(AbstractEventDriver.java:161)\n\tat org.eclipse.jetty.websocket.common.WebSocketSession.incomingFrame(WebSocketSession.java:309)\n\tat org.eclipse.jetty.websocket.common.extensions.ExtensionStack.incomingFrame(ExtensionStack.java:214)\n\tat org.eclipse.jetty.websocket.common.Parser.notifyFrame(Parser.java:220)\n\tat org.eclipse.jetty.websocket.common.Parser.parse(Parser.java:258)\n\tat org.eclipse.jetty.websocket.common.io.AbstractWebSocketConnection.readParse(AbstractWebSocketConnection.java:632)\n\tat org.eclipse.jetty.websocket.common.io.AbstractWebSocketConnection.onFillable(AbstractWebSocketConnection.java:480)\n\tat org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:544)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)\n\tat java.lang.Thread.run(Thread.java:745)\n","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3520"},{"text":"%spark.pyspark\n\nimport pyspark.sql.functions as sqlfn\n\ndfB = df.where(\"_c1 = 'B'\").withColumn(\"label\", sqlfn.lit(0))\n\ndfM = df.where(\"_c1 = 'M'\").withColumn(\"label\", sqlfn.lit(1))\n\ndfALL = dfB.union(dfM)","user":"anonymous","dateUpdated":"2017-03-30T14:10:16-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1490892130593_483961889","id":"20170330-134210_41578637","dateCreated":"2017-03-30T13:42:10-0300","dateStarted":"2017-03-30T14:10:16-0300","dateFinished":"2017-03-30T14:10:16-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3521"},{"text":"%spark.pyspark\ndfALL.columns()","user":"anonymous","dateUpdated":"2017-03-30T14:10:16-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-1930990485601994885.py\", line 344, in <module>\n    raise Exception(traceback.format_exc())\nException: Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-1930990485601994885.py\", line 337, in <module>\n    exec(code)\n  File \"<stdin>\", line 1, in <module>\nTypeError: 'list' object is not callable\n\n"}]},"apps":[],"jobName":"paragraph_1490893256848_-811875172","id":"20170330-140056_2031825638","dateCreated":"2017-03-30T14:00:56-0300","dateStarted":"2017-03-30T14:10:17-0300","dateFinished":"2017-03-30T14:10:17-0300","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:3522"},{"text":"%spark.pyspark\nimport pyspark.sql.functions as sqlfn\n\n#sobre o arquivo: http://archive.ics.uci.edu/ml/machine-learning-databases/breast-cancer-wisconsin/wdbc.names\n\n#já sei que é em csv\ndf = spark.read.csv('data/wdbc.data', inferSchema = True)\n\n#df.printSchema()\n#apenas benígno\n#df.where(\"_c1 = 'B'\").show()\n#df.columns\n\ndf2 = spark.read.csv('data/breast-cancer-wisconsin.data')\n\n#Adicionar uma coluna - Quando for benigno = 0\ndfB = df.where(\"_c1 = 'B'\").withColumn(\"label\", sqlfn.lit(0))\n\n#Adicionar uma coluna - Quando for maligno = 1\ndfM = df.where(\"_c1 = 'M'\").withColumn(\"label\", sqlfn.lit(1))\n\n#union pra deixar td no mesmo data frame\ndfAll = dfB.union(dfM)","user":"anonymous","dateUpdated":"2017-03-30T14:10:16-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1490893268424_-1218908860","id":"20170330-140108_916380967","dateCreated":"2017-03-30T14:01:08-0300","dateStarted":"2017-03-30T14:10:17-0300","dateFinished":"2017-03-30T14:10:17-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3523"},{"text":"%spark.pyspark\n\nfeatures = ['_c2', '_c3', '_c4', '_c5', '_c6', '_c7', '_c8', '_c9', '_c10', '_c11', '_c12', '_c13', '_c14', '_c15', '_c16', '_c17', '_c18', '_c19', '_c20', '_c21', '_c22', '_c23', '_c24', '_c25', '_c26', '_c27', '_c28', '_c29', '_c30', '_c31']","user":"anonymous","dateUpdated":"2017-03-30T14:10:16-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1490893453721_2057657102","id":"20170330-140413_2081229174","dateCreated":"2017-03-30T14:04:13-0300","dateStarted":"2017-03-30T14:10:17-0300","dateFinished":"2017-03-30T14:10:17-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3524"},{"text":"%spark.pyspark\n\nfrom pyspark.ml.feature import VectorAssembler\n\nassemble = VectorAssembler(inputCols=features, outputCol=\"features\")\ndata = assembler.transform(dfAll)\n\ndataALL = data.withColumnRenamed('_c0', 'id')\ndataALL.columns","user":"anonymous","dateUpdated":"2017-03-30T14:11:11-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['id', '_c1', '_c2', '_c3', '_c4', '_c5', '_c6', '_c7', '_c8', '_c9', '_c10', '_c11', '_c12', '_c13', '_c14', '_c15', '_c16', '_c17', '_c18', '_c19', '_c20', '_c21', '_c22', '_c23', '_c24', '_c25', '_c26', '_c27', '_c28', '_c29', '_c30', '_c31', 'label', 'features']\n"}]},"apps":[],"jobName":"paragraph_1490893465346_1337822558","id":"20170330-140425_1092157273","dateCreated":"2017-03-30T14:04:25-0300","dateStarted":"2017-03-30T14:11:11-0300","dateFinished":"2017-03-30T14:11:11-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3525"},{"text":"%spark.pyspark\nfrom pyspark.ml.classification import DecisionTreeClassifier\n\n(treinamento, teste) = dataALL.randomSplit([0.8, 0.2])","user":"anonymous","dateUpdated":"2017-03-30T14:17:23-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490893583570_-352978648","id":"20170330-140623_168933834","dateCreated":"2017-03-30T14:06:23-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3526","dateFinished":"2017-03-30T14:17:23-0300","dateStarted":"2017-03-30T14:17:23-0300","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark.pyspark\n\ndt = DecisionTreeClassifier(labelCol='label', featuresCol='features', maxDepth=5)","user":"anonymous","dateUpdated":"2017-03-30T14:18:27-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490893936959_142078816","id":"20170330-141216_147096354","dateCreated":"2017-03-30T14:12:16-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4042","dateFinished":"2017-03-30T14:18:27-0300","dateStarted":"2017-03-30T14:18:27-0300","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark.pyspark\nmodel = dt.fit(treinamento)","user":"anonymous","dateUpdated":"2017-03-30T14:23:35-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490894307512_1958446080","id":"20170330-141827_438493459","dateCreated":"2017-03-30T14:18:27-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4116","dateFinished":"2017-03-30T14:23:36-0300","dateStarted":"2017-03-30T14:23:35-0300","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark.pyspark\n\npredictionshve = model.transform(teste)","user":"anonymous","dateUpdated":"2017-03-30T14:36:26-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490894578829_636431891","id":"20170330-142258_1405509899","dateCreated":"2017-03-30T14:22:58-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4172","dateFinished":"2017-03-30T14:36:27-0300","dateStarted":"2017-03-30T14:36:26-0300","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark.pyspark\npredictionshve.select('label', 'prediction').show(5)","user":"anonymous","dateUpdated":"2017-03-30T14:36:28-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490894678441_518853614","id":"20170330-142438_528808815","dateCreated":"2017-03-30T14:24:38-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4261","dateFinished":"2017-03-30T14:36:28-0300","dateStarted":"2017-03-30T14:36:28-0300","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+----------+\n|label|prediction|\n+-----+----------+\n|    0|       0.0|\n|    0|       0.0|\n|    0|       0.0|\n|    0|       0.0|\n|    0|       0.0|\n+-----+----------+\nonly showing top 5 rows\n\n"}]}},{"text":"%spark.pyspark\npredictionshve.groupBy('prediction', 'label').count().show()","user":"anonymous","dateUpdated":"2017-03-30T14:38:03-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490894748758_1715853938","id":"20170330-142548_672126707","dateCreated":"2017-03-30T14:25:48-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4317","dateFinished":"2017-03-30T14:38:05-0300","dateStarted":"2017-03-30T14:38:03-0300","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+-----+-----+\n|prediction|label|count|\n+----------+-----+-----+\n|       1.0|    0|    6|\n|       0.0|    0|   61|\n|       0.0|    1|    8|\n|       1.0|    1|   33|\n+----------+-----+-----+\n\n"}]}},{"text":"%spark.pyspark\n\nfrom pyspark.ml.clustering import KMeans\n\n\nmodelhve = KMeans(featuresCol=\"features\").setK(2).setSeed(95).fit(dataALL)","user":"anonymous","dateUpdated":"2017-03-30T14:41:11-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490894883867_195927217","id":"20170330-142803_1710302627","dateCreated":"2017-03-30T14:28:03-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4422","dateFinished":"2017-03-30T14:41:12-0300","dateStarted":"2017-03-30T14:41:11-0300","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark.pyspark\ngrouposhve = modelhve.transform(data)","user":"anonymous","dateUpdated":"2017-03-30T14:42:09-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490895671055_-1841399764","id":"20170330-144111_1283646230","dateCreated":"2017-03-30T14:41:11-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4988","dateFinished":"2017-03-30T14:42:11-0300","dateStarted":"2017-03-30T14:42:10-0300","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark.pyspark\ngrouposhve.groupBy('prediction', 'label').count().show()\n","user":"anonymous","dateUpdated":"2017-03-30T14:42:46-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490895729338_1884031891","id":"20170330-144209_2045018701","dateCreated":"2017-03-30T14:42:09-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5056","dateFinished":"2017-03-30T14:42:49-0300","dateStarted":"2017-03-30T14:42:46-0300","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+-----+-----+\n|prediction|label|count|\n+----------+-----+-----+\n|         1|    0|  356|\n|         1|    1|   82|\n|         0|    0|    1|\n|         0|    1|  130|\n+----------+-----+-----+\n\n"}]}},{"text":"%spark.pyspark\n\nk_wssse_hve = []\nk_values_hve = range(2,15)\nk_models_hve = []\nk_pred_hve = []\n\nfor k in k_values_hve:\n    modelhve = KMeans(featuresCol=\"features\").setK(k).setSeed(95).fit(dataALL)\n    k_wssse_hve.append(modelhve.computeCost(dataALL))\n    k_models_hve.append(modelhve)\n    k_pred_hve.append(modelhve.transform(dataALL))","user":"anonymous","dateUpdated":"2017-03-30T14:51:41-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490895753085_-141640420","id":"20170330-144233_855147029","dateCreated":"2017-03-30T14:42:33-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5112","dateFinished":"2017-03-30T14:52:50-0300","dateStarted":"2017-03-30T14:52:24-0300","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark.pyspark\nfor k in k_values_hve:\n    k_pred_hve[k-2].groupBy('prediction').count().show()","user":"anonymous","dateUpdated":"2017-03-30T14:54:11-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490896247220_1392455257","id":"20170330-145047_623592941","dateCreated":"2017-03-30T14:50:47-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5215","dateFinished":"2017-03-30T14:56:02-0300","dateStarted":"2017-03-30T14:55:25-0300","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+-----+\n|prediction|count|\n+----------+-----+\n|         1|  438|\n|         0|  131|\n+----------+-----+\n\n+----------+-----+\n|prediction|count|\n+----------+-----+\n|         1|   19|\n|         2|  125|\n|         0|  425|\n+----------+-----+\n\n+----------+-----+\n|prediction|count|\n+----------+-----+\n|         1|   16|\n|         3|   87|\n|         2|  146|\n|         0|  320|\n+----------+-----+\n\n+----------+-----+\n|prediction|count|\n+----------+-----+\n|         1|  248|\n|         3|   12|\n|         4|  177|\n|         2|   77|\n|         0|   55|\n+----------+-----+\n\n+----------+-----+\n|prediction|count|\n+----------+-----+\n|         1|  130|\n|         3|  113|\n|         5|  191|\n|         4|   13|\n|         2|   69|\n|         0|   53|\n+----------+-----+\n\n+----------+-----+\n|prediction|count|\n+----------+-----+\n|         1|  182|\n|         6|   70|\n|         3|    1|\n|         5|  208|\n|         4|   37|\n|         2|   59|\n|         0|   12|\n+----------+-----+\n\n+----------+-----+\n|prediction|count|\n+----------+-----+\n|         1|  186|\n|         6|  108|\n|         3|    1|\n|         5|  135|\n|         4|   21|\n|         7|   54|\n|         2|   54|\n|         0|   10|\n+----------+-----+\n\n+----------+-----+\n|prediction|count|\n+----------+-----+\n|         1|  135|\n|         6|    6|\n|         3|    1|\n|         5|  186|\n|         4|   52|\n|         8|   50|\n|         7|    9|\n|         2|   22|\n|         0|  108|\n+----------+-----+\n\n+----------+-----+\n|prediction|count|\n+----------+-----+\n|         1|   91|\n|         6|   59|\n|         3|    1|\n|         5|  179|\n|         9|   29|\n|         4|    6|\n|         8|    9|\n|         7|    5|\n|         2|   51|\n|         0|  139|\n+----------+-----+\n\n+----------+-----+\n|prediction|count|\n+----------+-----+\n|         1|   78|\n|         6|    6|\n|         3|   48|\n|         5|  118|\n|         9|   29|\n|         4|    1|\n|         8|   87|\n|         7|    5|\n|        10|  138|\n|         2|    9|\n|         0|   50|\n+----------+-----+\n\n+----------+-----+\n|prediction|count|\n+----------+-----+\n|         1|  108|\n|         6|    1|\n|         3|    6|\n|         5|   78|\n|         9|    7|\n|         4|   71|\n|         8|   42|\n|         7|    5|\n|        10|  134|\n|        11|   45|\n|         2|   27|\n|         0|   45|\n+----------+-----+\n\n+----------+-----+\n|prediction|count|\n+----------+-----+\n|        12|   76|\n|         1|   84|\n|         6|   68|\n|         3|   42|\n|         5|   62|\n|         9|   21|\n|         4|    5|\n|         8|   25|\n|         7|    7|\n|        10|  100|\n|        11|   31|\n|         2|    9|\n|         0|   39|\n+----------+-----+\n\n+----------+-----+\n|prediction|count|\n+----------+-----+\n|        12|   62|\n|         1|   67|\n|        13|   85|\n|         6|    1|\n|         3|    6|\n|         5|   56|\n|         9|    9|\n|         4|   58|\n|         8|   41|\n|         7|    4|\n|        10|   65|\n|        11|   45|\n|         2|   27|\n|         0|   43|\n+----------+-----+\n\n"}]}},{"text":"%spark.pyspark\nfor k in k_values_hve:\n    k_pred_hve[k-2].groupBy('prediction', 'label').count().show()","user":"anonymous","dateUpdated":"2017-03-30T14:54:19-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490896451339_-408094619","id":"20170330-145411_1311268348","dateCreated":"2017-03-30T14:54:11-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5302","dateFinished":"2017-03-30T14:57:01-0300","dateStarted":"2017-03-30T14:56:22-0300","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+-----+-----+\n|prediction|label|count|\n+----------+-----+-----+\n|         1|    0|  356|\n|         1|    1|   82|\n|         0|    0|    1|\n|         0|    1|  130|\n+----------+-----+-----+\n\n+----------+-----+-----+\n|prediction|label|count|\n+----------+-----+-----+\n|         1|    1|   19|\n|         0|    0|  355|\n|         2|    1|  123|\n|         2|    0|    2|\n|         0|    1|   70|\n+----------+-----+-----+\n\n+----------+-----+-----+\n|prediction|label|count|\n+----------+-----+-----+\n|         3|    1|   87|\n|         1|    1|   16|\n|         0|    0|  305|\n|         2|    1|   94|\n|         2|    0|   52|\n|         0|    1|   15|\n+----------+-----+-----+\n\n+----------+-----+-----+\n|prediction|label|count|\n+----------+-----+-----+\n|         1|    0|  243|\n|         3|    1|   12|\n|         4|    0|  112|\n|         1|    1|    5|\n|         2|    1|   75|\n|         2|    0|    2|\n|         0|    1|   55|\n|         4|    1|   65|\n+----------+-----+-----+\n\n+----------+-----+-----+\n|prediction|label|count|\n+----------+-----+-----+\n|         1|    0|  128|\n|         3|    1|   63|\n|         1|    1|    2|\n|         2|    1|   68|\n|         2|    0|    1|\n|         0|    1|   53|\n|         5|    0|  178|\n|         5|    1|   13|\n|         3|    0|   50|\n|         4|    1|   13|\n+----------+-----+-----+\n\n+----------+-----+-----+\n|prediction|label|count|\n+----------+-----+-----+\n|         1|    0|  145|\n|         6|    1|   61|\n|         3|    1|    1|\n|         6|    0|    9|\n|         1|    1|   37|\n|         2|    1|   59|\n|         0|    1|   12|\n|         5|    0|  203|\n|         5|    1|    5|\n|         4|    1|   37|\n+----------+-----+-----+\n\n+----------+-----+-----+\n|prediction|label|count|\n+----------+-----+-----+\n|         1|    0|  173|\n|         6|    1|   59|\n|         3|    1|    1|\n|         7|    1|   54|\n|         6|    0|   49|\n|         1|    1|   13|\n|         2|    1|   52|\n|         2|    0|    2|\n|         0|    1|   10|\n|         5|    0|  133|\n|         5|    1|    2|\n|         4|    1|   21|\n+----------+-----+-----+\n\n+----------+-----+-----+\n|prediction|label|count|\n+----------+-----+-----+\n|         1|    0|  133|\n|         6|    1|    6|\n|         3|    1|    1|\n|         7|    1|    9|\n|         4|    0|    2|\n|         1|    1|    2|\n|         0|    0|   49|\n|         8|    1|   50|\n|         2|    1|   22|\n|         0|    1|   59|\n|         5|    0|  173|\n|         5|    1|   13|\n|         4|    1|   50|\n+----------+-----+-----+\n\n+----------+-----+-----+\n|prediction|label|count|\n+----------+-----+-----+\n|         1|    0|   91|\n|         6|    1|   54|\n|         3|    1|    1|\n|         7|    1|    5|\n|         9|    1|   29|\n|         6|    0|    5|\n|         0|    0|   88|\n|         8|    1|    9|\n|         2|    1|   51|\n|         0|    1|   51|\n|         5|    0|  173|\n|         5|    1|    6|\n|         4|    1|    6|\n+----------+-----+-----+\n\n+----------+-----+-----+\n|prediction|label|count|\n+----------+-----+-----+\n|         1|    0|   78|\n|         6|    1|    6|\n|         3|    1|   48|\n|         7|    1|    5|\n|         9|    1|   29|\n|         0|    0|    3|\n|        10|    1|    5|\n|         8|    1|   47|\n|         2|    1|    9|\n|         0|    1|   47|\n|         5|    0|  103|\n|         8|    0|   40|\n|         5|    1|   15|\n|        10|    0|  133|\n|         4|    1|    1|\n+----------+-----+-----+\n\n+----------+-----+-----+\n|prediction|label|count|\n+----------+-----+-----+\n|         1|    0|   98|\n|         6|    1|    1|\n|         3|    1|    6|\n|         7|    1|    5|\n|        11|    1|   44|\n|         9|    1|    7|\n|         4|    0|   44|\n|         1|    1|   10|\n|         0|    0|    7|\n|        10|    1|    5|\n|         8|    1|   42|\n|         2|    1|   27|\n|        11|    0|    1|\n|         0|    1|   38|\n|         5|    0|   78|\n|        10|    0|  129|\n|         4|    1|   27|\n+----------+-----+-----+\n\n+----------+-----+-----+\n|prediction|label|count|\n+----------+-----+-----+\n|         1|    0|   73|\n|         6|    1|   26|\n|         3|    1|   42|\n|         7|    1|    7|\n|        11|    1|   30|\n|         9|    1|   21|\n|         6|    0|   42|\n|        12|    1|    2|\n|         1|    1|   11|\n|         0|    0|    8|\n|        10|    1|    3|\n|         8|    1|   25|\n|         2|    1|    9|\n|        12|    0|   74|\n|        11|    0|    1|\n|         0|    1|   31|\n|         5|    0|   62|\n|        10|    0|   97|\n|         4|    1|    5|\n+----------+-----+-----+\n\n+----------+-----+-----+\n|prediction|label|count|\n+----------+-----+-----+\n|         1|    0|   53|\n|         6|    1|    1|\n|         3|    1|    6|\n|         7|    1|    4|\n|        11|    1|   44|\n|         9|    1|    9|\n|         4|    0|   34|\n|        12|    1|    1|\n|         1|    1|   14|\n|         0|    0|    7|\n|        10|    1|    1|\n|         8|    1|   41|\n|         2|    1|   27|\n|        12|    0|   61|\n|        11|    0|    1|\n|         0|    1|   36|\n|        13|    0|   81|\n|         5|    0|   56|\n|        10|    0|   64|\n|         4|    1|   24|\n+----------+-----+-----+\nonly showing top 20 rows\n\n"}]}},{"text":"%spark.pyspark\n\n# Workflow \n# KMeans > diff(features do individuo do cluster, pro cluster) > Classificador(Decision Tree)","user":"anonymous","dateUpdated":"2017-03-30T15:06:58-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490896459680_774638824","id":"20170330-145419_23230411","dateCreated":"2017-03-30T14:54:19-0300","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5358"}],"name":"hvehrenfried3","id":"2CD5JVNJP","angularObjects":{"2C9BJDF71:shared_process":[],"2CA48URHJ:shared_process":[],"2C7WPSS7Z:shared_process":[],"2C6XSXTG6:shared_process":[],"2C9MUFN7T:shared_process":[],"2CA3NX254:shared_process":[],"2CAGDTKQW:shared_process":[],"2C8DAACDP:shared_process":[],"2C89WSY73:shared_process":[],"2C9AFPAG7:shared_process":[],"2C9C28FR6:shared_process":[],"2CA264QZ3:shared_process":[],"2C8K3X79M:shared_process":[],"2CAEVM34E:shared_process":[],"2C7SGT8S6:shared_process":[],"2C82EREVW:shared_process":[],"2C8UQZG7B:shared_process":[],"2C988KJAT:shared_process":[],"2C7E1FE49:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}