{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490378549380_990099330","id":"20170324-150229_1112116428","dateCreated":"2017-03-24T15:02:29-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:251","text":"%spark.pyspark\n\nimport urllib\nimport ssl\nimport csv\nimport datetime as dt\nimport matplotlib.pyplot as pp\n\nurl_alvaras_ctba=\"http://multimidia.curitiba.pr.gov.br/dadosabertos/BaseAlvaras/2017-03-01_Alvaras-Base_de_Dados.CSV\"\nurl_156=\"http://multimidia.curitiba.pr.gov.br/dadosabertos/156/2017-03-01_156_-_Base_de_Dados.csv\"\nurl_unidades_atendimento_ativas=\"http://multimidia.curitiba.pr.gov.br/dadosabertos/UnidadesAtendimentoCuritiba/2017-02-21_Unidades_Atendimento_Ativas_Curitiba_-_Base_de_Dados.csv\"\nurl_feiras_ctba=\"http://multimidia.curitiba.pr.gov.br/dadosabertos/feirascuritiba/2016-12-05_Feiras_Curitiba_-_Base_de_Dados.xls\"\nurl_guarda_municipal=\"http://multimidia.curitiba.pr.gov.br/dadosabertos/Sigesguarda/2017-03-01_sigesguarda_-_Base_de_Dados.csv\"\nurl_eventos_ctba=\"http://multimidia.curitiba.pr.gov.br/dadosabertos/agendapmc/2017-03-24_Eventos_-_Base_de_Dados.csv\"\n\nresponse1 = urllib.urlretrieve(url_alvaras_ctba, \"alvara.csv\")\nresponse2 = urllib.urlretrieve(url_156, \"156.csv\")\nresponse3 = urllib.urlretrieve(url_unidades_atendimento_ativas, \"atendimentoAtivo.csv\")\nresponse5 = urllib.urlretrieve(url_guarda_municipal, \"guarda.csv\")\nresponse6 = urllib.urlretrieve(url_eventos_ctba, \"eventos.csv\")\n\n","dateUpdated":"2017-03-24T16:21:16-0300","dateFinished":"2017-03-24T16:23:21-0300","dateStarted":"2017-03-24T16:21:16-0300","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark.pyspark\n\nalvara = spark.read.format(\"com.databricks.spark.csv\")\\\n    .option('delimiter', ';')\\\n    .option('charset', 'iso-8859-1')\\\n    .option('header', \"true\")\\\n    .load(\"alvara.csv\")\nprefeitura = spark.read.format(\"com.databricks.spark.csv\")\\\n    .option('delimiter', ';')\\\n    .option('charset', 'iso-8859-1')\\\n    .option('header', \"true\")\\\n    .load(\"156.csv\")\natendimento = spark.read.format(\"com.databricks.spark.csv\")\\\n    .option('delimiter', ',')\\\n    .option('charset', 'ascii')\\\n    .option('header', \"true\")\\\n    .load(\"atendimentoAtivo.csv\")\nguarda = spark.read.format(\"com.databricks.spark.csv\")\\\n    .option('delimiter', ';')\\\n    .option('charset', 'iso-8859-1')\\\n    .option('header', \"true\")\\\n    .load(\"guarda.csv\")\neventos = spark.read.format(\"com.databricks.spark.csv\")\\\n    .option('delimiter', ';')\\\n    .option('charset', 'iso-8859-1')\\\n    .option('header', \"true\")\\\n    .load(\"eventos.csv\")\n","user":"anonymous","dateUpdated":"2017-03-24T16:25:49-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490379200254_-233512207","id":"20170324-151320_884532674","dateCreated":"2017-03-24T15:13:20-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:413","dateFinished":"2017-03-24T16:25:49-0300","dateStarted":"2017-03-24T16:25:49-0300","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark.pyspark\n\nprint \"Alvara\"\nalvara.printSchema()\nprint \"-----------------\"\nprint \"156\"\nprefeitura.printSchema()\nprint \"-----------------\"\nprint \"Atendimento\"\natendimento.printSchema()\nprint \"-----------------\"\nprint \"Guarda\"\nguarda.printSchema()\nprint \"-----------------\"\nprint \"Eventos\"\neventos.printSchema()\nprint \"-----------------\"","user":"anonymous","dateUpdated":"2017-03-24T16:27:22-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490381013206_-836993884","id":"20170324-154333_1789168420","dateCreated":"2017-03-24T15:43:33-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:837","dateFinished":"2017-03-24T16:27:22-0300","dateStarted":"2017-03-24T16:27:22-0300","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Alvara\nroot\n |-- NOME_EMPRESARIAL: string (nullable = true)\n |-- INICIO_ATIVIDADE: string (nullable = true)\n |-- NUMERO_DO_ALVARA: string (nullable = true)\n |-- NOME_DA_EMPRESA: string (nullable = true)\n |-- DATA_EMISSAO: string (nullable = true)\n |-- DATA_EXPIRACAO: string (nullable = true)\n |-- ATIVIDADE_PRINCIPAL: string (nullable = true)\n |-- ATIVIDADE_SECUNDARIA1: string (nullable = true)\n |-- ATIVIDADE_SECUNDARIA2: string (nullable = true)\n |-- ENDERECO: string (nullable = true)\n |-- NUMERO: string (nullable = true)\n |-- UNIDADE: string (nullable = true)\n |-- ANDAR: string (nullable = true)\n |-- COMPLEMENTO: string (nullable = true)\n |-- BAIRRO: string (nullable = true)\n |-- CEP: string (nullable = true)\n\n-----------------\n156\nroot\n |-- SOLICITACAO: string (nullable = true)\n |-- TIPO: string (nullable = true)\n |-- ORGAO: string (nullable = true)\n |-- DATA: string (nullable = true)\n |-- HORARIO: string (nullable = true)\n |-- ASSUNTO: string (nullable = true)\n |-- SUBDIVISAO: string (nullable = true)\n |-- DESCRICAO: string (nullable = true)\n |-- LOGRADOURO_ASS: string (nullable = true)\n |-- BAIRRO_ASS: string (nullable = true)\n |-- REGIONAL_ASS: string (nullable = true)\n |-- MEIO_RESPOSTA: string (nullable = true)\n |-- OBSERVACAO: string (nullable = true)\n |-- SEXO: string (nullable = true)\n |-- BAIRRO_CIDADAO: string (nullable = true)\n |-- REGIONAL_CIDADAO: string (nullable = true)\n |-- DATA_NASC: string (nullable = true)\n |-- TIPO_CIDADAO: string (nullable = true)\n |-- ORGAO_RESP: string (nullable = true)\n |-- RESPOSTA_FINAL: string (nullable = true)\n\n-----------------\nAtendimento\nroot\n |-- CD_EQUI: string (nullable = true)\n |-- CD_LOCAL: string (nullable = true)\n |-- CD_TEMA: string (nullable = true)\n |-- DS_TEMA: string (nullable = true)\n |-- CD_TP_EQUIPAMENTO: string (nullable = true)\n |-- DS_TP_EQUIPAMENTO: string (nullable = true)\n |-- CD_SUBTIPO_EQUIPAMENTO: string (nullable = true)\n |-- DS_SUBTIPO_EQUIPAMENTO: string (nullable = true)\n |-- CD_DEP_ADMINISTRATIVA: string (nullable = true)\n |-- DS_DEP_ADMINISTRATIVA: string (nullable = true)\n |-- NM_EQUI: string (nullable = true)\n |-- NM_ABREV_EQUI: string (nullable = true)\n |-- CD_FONTE: string (nullable = true)\n |-- FONTE_FONTE: string (nullable = true)\n |-- CD_RUA: string (nullable = true)\n |-- NM_RUA: string (nullable = true)\n |-- CD_RUANAOOFICIAL: string (nullable = true)\n |-- NM_RUANAOOFICIAL: string (nullable = true)\n |-- NUMERO_EQUI: string (nullable = true)\n |-- COMPLEMENTO_EQUI: string (nullable = true)\n |-- CD_BAIRRO: string (nullable = true)\n |-- NM_BAIRRO: string (nullable = true)\n |-- QUADRICULA_BQ: string (nullable = true)\n |-- CD_REGIONAL: string (nullable = true)\n |-- NM_REGIONAL: string (nullable = true)\n |-- LAT_SIRGAS: string (nullable = true)\n |-- LON_SIRGAS: string (nullable = true)\n |-- FUNCIONAMENTO_MANHA_EQUI: string (nullable = true)\n |-- FUNCIONAMENTO_TARDE_EQUI: string (nullable = true)\n |-- FUNCIONAMENTO_NOITE_EQUI: string (nullable = true)\n |-- FUNCIONAMENTO_24HRS_EQUI: string (nullable = true)\n |-- TELEFONE_EQUI: string (nullable = true)\n |-- RAMAL_EQUI: string (nullable = true)\n |-- EMAIL_EQUI: string (nullable = true)\n |-- SITE_EQUI: string (nullable = true)\n |-- FAX_EQUI: string (nullable = true)\n\n-----------------\nGuarda\nroot\n |-- ATENDIMENTO_ANO: string (nullable = true)\n |-- ATENDIMENTO_BAIRRO_NOME: string (nullable = true)\n |-- EQUIPAMENTO_URBANO_NOME: string (nullable = true)\n |-- FLAG_EQUIPAMENTO_URBANO: string (nullable = true)\n |-- FLAG_FLAGRANTE: string (nullable = true)\n |-- LOGRADOURO_NOME: string (nullable = true)\n |-- NATUREZA1_DEFESA_CIVIL: string (nullable = true)\n |-- NATUREZA1_DESCRICAO: string (nullable = true)\n |-- NATUREZA2_DEFESA_CIVIL: string (nullable = true)\n |-- NATUREZA2_DESCRICAO: string (nullable = true)\n |-- NATUREZA3_DEFESA_CIVIL: string (nullable = true)\n |-- NATUREZA3_DESCRICAO: string (nullable = true)\n |-- NATUREZA4_DEFESA_CIVIL: string (nullable = true)\n |-- NATUREZA4_DESCRICAO: string (nullable = true)\n |-- NATUREZA5_DEFESA_CIVIL: string (nullable = true)\n |-- NATUREZA5_DESCRICAO: string (nullable = true)\n |-- SUBCATEGORIA1_DESCRICAO: string (nullable = true)\n |-- SUBCATEGORIA2_DESCRICAO: string (nullable = true)\n |-- SUBCATEGORIA3_DESCRICAO: string (nullable = true)\n |-- SUBCATEGORIA4_DESCRICAO: string (nullable = true)\n |-- SUBCATEGORIA5_DESCRICAO: string (nullable = true)\n |-- OCORRENCIA_ANO: string (nullable = true)\n |-- OCORRENCIA_CODIGO: string (nullable = true)\n |-- OCORRENCIA_DATA: string (nullable = true)\n |-- OCORRENCIA_DIA_SEMANA: string (nullable = true)\n |-- OCORRENCIA_HORA: string (nullable = true)\n |-- OCORRENCIA_MES: string (nullable = true)\n |-- OPERACAO_DESCRICAO: string (nullable = true)\n |-- ORIGEM_CHAMADO_DESCRICAO: string (nullable = true)\n |-- REGIONAL_FATO_NOME: string (nullable = true)\n |-- SECRETARIA_NOME: string (nullable = true)\n |-- SECRETARIA_SIGLA: string (nullable = true)\n |-- SERVICO_NOME: string (nullable = true)\n |-- SITUACAO_EQUIPE_DESCRICAO: string (nullable = true)\n |-- NUMERO_PROTOCOLO_156: string (nullable = true)\n\n-----------------\nEventos\nroot\n |-- EVE_IDF: string (nullable = true)\n |-- EVE_TITULO: string (nullable = true)\n |-- EVE_DESCRICAO: string (nullable = true)\n |-- EVE_PUBLICADO: string (nullable = true)\n |-- EVE_DATA_INICIO: string (nullable = true)\n |-- EVE_DATA_TERMINO: string (nullable = true)\n |-- SEE_STR_NOME: string (nullable = true)\n |-- EVE_DATA_CADASTRO: string (nullable = true)\n |-- EVE_LOCAL: string (nullable = true)\n |-- EVE_ENDERECO: string (nullable = true)\n |-- EVE_HORARIO: string (nullable = true)\n |-- EVE_REPETIR: string (nullable = true)\n |-- EVE_DIA: string (nullable = true)\n |-- BAI_DESCRICAO: string (nullable = true)\n |-- ETE_DESCRICAO: string (nullable = true)\n |-- ETI_DESCRICAO: string (nullable = true)\n |-- REG_DESCRICAO: string (nullable = true)\n\n-----------------\n"}]}},{"text":"%spark.pyspark\n","user":"anonymous","dateUpdated":"2017-03-24T16:25:56-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490383556594_-1562430571","id":"20170324-162556_1756143921","dateCreated":"2017-03-24T16:25:56-0300","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1420"}],"name":"Trabalho 1","id":"2CBFQT5HD","angularObjects":{"2C9BJDF71:shared_process":[],"2CA48URHJ:shared_process":[],"2C7WPSS7Z:shared_process":[],"2C6XSXTG6:shared_process":[],"2C9MUFN7T:shared_process":[],"2CA3NX254:shared_process":[],"2CAGDTKQW:shared_process":[],"2C8DAACDP:shared_process":[],"2C89WSY73:shared_process":[],"2C9AFPAG7:shared_process":[],"2C9C28FR6:shared_process":[],"2CA264QZ3:shared_process":[],"2C8K3X79M:shared_process":[],"2CAEVM34E:shared_process":[],"2C7SGT8S6:shared_process":[],"2C82EREVW:shared_process":[],"2C8UQZG7B:shared_process":[],"2C988KJAT:shared_process":[],"2C7E1FE49:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}