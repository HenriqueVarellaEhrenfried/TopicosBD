{"paragraphs":[{"text":"%spark.pyspark\n\nimport urllib\nimport ssl\nimport csv\nimport datetime as dt\nimport matplotlib.pyplot as pp\nfrom pyspark.sql.types import StringType, StructField, StructType, BooleanType, ArrayType, IntegerType\nfrom pyspark.sql import Row\nfrom pyspark.sql import SQLContext\nimport folium\n","user":"anonymous","dateUpdated":"2017-04-04T18:06:14-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1490378549380_990099330","id":"20170324-150229_1112116428","dateCreated":"2017-03-24T15:02:29-0300","dateStarted":"2017-04-04T18:06:14-0300","dateFinished":"2017-04-04T18:06:14-0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:26"},{"text":"%spark.pyspark\n\nsqlContext = SQLContext(spark)\ndf = spark.read.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").load(\"data_pac/aeroporto.csv\")\n# df2 = spark.read.json(\"data_pac/pavimentacao.json\")\ndf2 = spark.read.json(\"data_pac/pavimentacao.json\")\n\n\ndf2.registerTempTable(\"pavimentacao\")\n# df2.printSchema()\n\ncoord_a = df2.select(\"features.geometry.coordinates\").collect()\nid_a = df2.select(\"features.id\").collect()\nempreend_a = df2.select(\"features.properties.empreendimento\").collect()\nestagio_a = df2.select(\"features.properties.estagio\").collect()\nlats = []\nlongs = []\nids = [] \nempreends = []\nestagios = []\ni = 0\n\n\nwhile(i < len(coord_a[0][0])):\n    longs.append(coord_a[0][0][i][0][0])\n    lats.append(coord_a[0][0][i][0][1])\n    ids.append(id_a[0][0][i])\n    empreends.append(empreend_a[0][0][i])\n    estagios.append(estagio_a[0][0][i])\n    i = i + 1\n    \n","user":"anonymous","dateUpdated":"2017-04-04T18:06:14-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1490381013206_-836993884","id":"20170324-154333_1789168420","dateCreated":"2017-03-24T15:43:33-0300","dateStarted":"2017-04-04T18:06:14-0300","dateFinished":"2017-04-04T18:06:14-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27"},{"text":"%spark.pyspark\ndf2.printSchema()","user":"anonymous","dateUpdated":"2017-04-04T18:06:14-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- crs: struct (nullable = true)\n |    |-- properties: struct (nullable = true)\n |    |    |-- code: string (nullable = true)\n |    |-- type: string (nullable = true)\n |-- features: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- geometry: struct (nullable = true)\n |    |    |    |-- coordinates: array (nullable = true)\n |    |    |    |    |-- element: array (containsNull = true)\n |    |    |    |    |    |-- element: double (containsNull = true)\n |    |    |    |-- type: string (nullable = true)\n |    |    |-- geometry_name: string (nullable = true)\n |    |    |-- id: string (nullable = true)\n |    |    |-- properties: struct (nullable = true)\n |    |    |    |-- codigo: string (nullable = true)\n |    |    |    |-- count: long (nullable = true)\n |    |    |    |-- data_de_referencia: string (nullable = true)\n |    |    |    |-- empreendimento: string (nullable = true)\n |    |    |    |-- estagio: string (nullable = true)\n |    |    |    |-- executor: string (nullable = true)\n |    |    |    |-- investimento_previsto: string (nullable = true)\n |    |    |    |-- municipio: string (nullable = true)\n |    |    |    |-- observacao: string (nullable = true)\n |    |    |    |-- orgao_responsavel: string (nullable = true)\n |    |    |    |-- subeixo: string (nullable = true)\n |    |    |    |-- tipo: string (nullable = true)\n |    |    |    |-- unidade_federativa: string (nullable = true)\n |    |    |-- type: string (nullable = true)\n |-- type: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1490383556594_-1562430571","id":"20170324-162556_1756143921","dateCreated":"2017-03-24T16:25:56-0300","dateStarted":"2017-04-04T18:06:14-0300","dateFinished":"2017-04-04T18:06:14-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28"},{"text":"%spark.pyspark\n\nlat = -25.45\nlgn = -49.22\n\nmymap = folium.Map(location=[lat,lgn], zoom_start=12)\nmymap.save('/home/henrique/Documentos/map.html')\n\ni = 0\nwhile (i < len(lats)):\n    folium.Marker([lats[i], longs[i]], popup=\"EMPREENDIMENTO: \" + empreends[i] + \" | STATUS: \" + estagios[i], icon = folium.Icon(color = 'green')).add_to(mymap)\n    i = i + 1\n    \nmymap.save('/home/henrique/Documentos/map.html')","user":"anonymous","dateUpdated":"2017-04-04T18:10:24-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1490384810425_-973157244","id":"20170324-164650_1253824186","dateCreated":"2017-03-24T16:46:50-0300","dateStarted":"2017-04-04T18:10:24-0300","dateFinished":"2017-04-04T18:10:42-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29"},{"text":"%spark.pyspark\n","user":"anonymous","dateUpdated":"2017-04-04T17:46:24-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1491338453339_194064459","id":"20170404-174053_825910823","dateCreated":"2017-04-04T17:40:53-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:30"}],"name":"Trabalho 1","id":"2CBFQT5HD","angularObjects":{"2C9BJDF71:shared_process":[],"2CA48URHJ:shared_process":[],"2C7WPSS7Z:shared_process":[],"2C6XSXTG6:shared_process":[],"2C9MUFN7T:shared_process":[],"2CA3NX254:shared_process":[],"2CAGDTKQW:shared_process":[],"2C8DAACDP:shared_process":[],"2C89WSY73:shared_process":[],"2C9AFPAG7:shared_process":[],"2C9C28FR6:shared_process":[],"2CA264QZ3:shared_process":[],"2C8K3X79M:shared_process":[],"2CAEVM34E:shared_process":[],"2C7SGT8S6:shared_process":[],"2C82EREVW:shared_process":[],"2C8UQZG7B:shared_process":[],"2C988KJAT:shared_process":[],"2C7E1FE49:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}